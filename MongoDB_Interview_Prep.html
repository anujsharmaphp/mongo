<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MongoDB Interview Prep</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: #f8f9fa; color: #1e293b; line-height: 1.6; }

        .layout { display: flex; min-height: 100vh; }

        /* Sidebar */
        .sidebar {
            width: 260px;
            min-width: 260px;
            background: #fff;
            border-right: 1px solid #e2e8f0;
            padding: 24px 0;
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            overflow-y: auto;
        }
        .sidebar h2 { font-size: 15px; color: #0f766e; padding: 0 20px; margin-bottom: 4px; }
        .sidebar .sub { font-size: 11px; color: #94a3b8; padding: 0 20px; margin-bottom: 20px; }
        .sidebar nav a {
            display: block;
            padding: 9px 20px;
            font-size: 13px;
            color: #475569;
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s;
        }
        .sidebar nav a:hover { background: #f0fdf4; color: #0f766e; border-left-color: #0f766e; }
        .sidebar nav a.active { background: #f0fdf4; color: #0f766e; border-left-color: #0f766e; font-weight: 600; }
        .sidebar nav a.pending { color: #cbd5e1; }

        /* Main content */
        .main { margin-left: 260px; padding: 30px 40px; max-width: 820px; }

        /* Concept block */
        .concept { background: #fff; border-radius: 10px; padding: 28px; margin-bottom: 24px; border: 1px solid #e2e8f0; }
        .concept h2 { font-size: 20px; color: #0f766e; margin-bottom: 4px; }
        .concept .tag { display: inline-block; background: #f0fdf4; color: #0f766e; font-size: 11px; padding: 2px 10px; border-radius: 20px; margin-bottom: 14px; font-weight: 500; }

        /* Simple points */
        .point { margin-bottom: 14px; }
        .point strong { color: #0f766e; font-size: 13px; }
        .point p { font-size: 13px; color: #475569; margin-top: 2px; }
        .point ul { padding-left: 18px; margin-top: 4px; }
        .point li { font-size: 12.5px; color: #475569; margin-bottom: 3px; }
        .point li strong { color: #1e293b; }

        /* Code */
        pre { background: #f1f5f9; border-radius: 8px; padding: 14px; overflow-x: auto; margin: 10px 0; border: 1px solid #e2e8f0; }
        code { font-family: 'Fira Code', monospace; font-size: 12px; color: #0f766e; }

        /* Q&A */
        .qa h3 { font-size: 13px; color: #b45309; margin: 18px 0 10px; text-transform: uppercase; letter-spacing: 1px; border-top: 1px solid #e2e8f0; padding-top: 16px; }
        .q { background: #fffbeb; border-radius: 8px; padding: 12px 14px; margin-bottom: 8px; border: 1px solid #fde68a; }
        .q .question { font-size: 13px; font-weight: 600; color: #1e293b; margin-bottom: 6px; }
        .q .answer { font-size: 12.5px; color: #57534e; }
        .q .answer strong { color: #1e293b; }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar { display: none; }
            .main { margin-left: 0; padding: 20px; }
        }
    </style>
</head>
<body>
<div class="layout">

    <!-- Sidebar -->
    <aside class="sidebar">
        <h2>MongoDB Prep</h2>
        <p class="sub">Interview Guide</p>
        <nav>
            <a href="#concept-1" class="active">1. Fundamentals</a>
            <a href="#concept-2" class="pending">2. Schema Design</a>
            <a href="#concept-3" class="pending">3. Indexing</a>
            <a href="#concept-4" class="pending">4. Aggregation</a>
            <a href="#concept-5" class="pending">5. Sharding</a>
            <a href="#concept-6" class="pending">6. Replication</a>
            <a href="#concept-7" class="pending">7. Atlas & Cloud</a>
            <a href="#concept-8" class="pending">8. Performance Tuning</a>
            <a href="#concept-9" class="pending">9. Transactions</a>
            <a href="#concept-10" class="pending">10. Security</a>
            <a href="#concept-11" class="pending">11. Kafka + MongoDB</a>
            <a href="#concept-12" class="pending">12. Mongo vs Elastic</a>
            <a href="#concept-13" class="pending">13. Project Scenarios</a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main">

        <!-- CONCEPT 1 -->
        <div class="concept" id="concept-1">
            <h2>1. Fundamentals & Architecture</h2>
            <span class="tag">Core Foundation</span>

            <div class="point">
                <strong>What is MongoDB?</strong>
                <p>NoSQL document database. Stores data as BSON (Binary JSON) documents. No fixed schema needed.</p>
            </div>

            <div class="point">
                <strong>Structure (vs MySQL)</strong>
                <ul>
                    <li><strong>Database</strong> = Database</li>
                    <li><strong>Collection</strong> = Table</li>
                    <li><strong>Document</strong> = Row (but flexible, no fixed columns)</li>
                    <li><strong>Field</strong> = Column</li>
                    <li><strong>_id</strong> = Primary Key (auto-generated 12-byte ObjectId)</li>
                </ul>
            </div>

            <div class="point">
                <strong>ObjectId (12 bytes)</strong>
                <p>4 bytes timestamp + 5 bytes random + 3 bytes counter. Sortable by creation time.</p>
            </div>

            <div class="point">
                <strong>WiredTiger Engine</strong>
                <ul>
                    <li><strong>Document-level locking</strong> &mdash; multiple writes to different docs at same time</li>
                    <li><strong>Compression</strong> &mdash; Snappy (default), zstd (better ratio)</li>
                    <li><strong>Journal</strong> &mdash; WAL synced every 50ms for crash recovery</li>
                    <li><strong>Checkpoint</strong> &mdash; flushes to disk every 60 seconds</li>
                    <li><strong>Cache</strong> &mdash; uses 50% of (RAM - 1GB)</li>
                </ul>
            </div>

            <div class="point">
                <strong>BSON vs JSON</strong>
                <p>BSON adds types: Date, ObjectId, Decimal128, Int64, BinData. Faster to parse. Max doc = <strong>16MB</strong>.</p>
            </div>

            <div class="point">
                <strong>CRUD Examples</strong>
<pre><code>// INSERT
db.patients.insertOne({ name: "Rajesh", age: 45, codes: ["E11", "I10"] })
db.patients.insertMany([{ name: "A" }, { name: "B" }])

// FIND
db.patients.find({ age: { $gte: 30 } })       // age >= 30
db.patients.find({ "records.bp": "140/90" })   // nested
db.patients.find({ codes: "E11" })             // array contains

// UPDATE
db.patients.updateOne(
  { name: "Rajesh" },
  { $set: { age: 46 }, $push: { codes: "M19" } }
)

// DELETE
db.patients.deleteMany({ age: { $lt: 18 } })</code></pre>
            </div>

            <div class="point">
                <strong>Key Operators (remember these)</strong>
                <ul>
                    <li><strong>Compare:</strong> $eq, $ne, $gt, $gte, $lt, $lte, $in, $nin</li>
                    <li><strong>Logic:</strong> $and, $or, $not, $nor</li>
                    <li><strong>Array:</strong> $all, $elemMatch, $size, $push, $pull, $addToSet</li>
                    <li><strong>Update:</strong> $set, $unset, $inc, $rename, $pop</li>
                    <li><strong>Element:</strong> $exists, $type</li>
                </ul>
            </div>

            <div class="point">
                <strong>Write Concern (durability level)</strong>
                <ul>
                    <li><code>w: 1</code> &mdash; acknowledged by primary only</li>
                    <li><code>w: "majority"</code> &mdash; acknowledged by majority of replica set</li>
                    <li><code>j: true</code> &mdash; wait until written to journal</li>
                </ul>
            </div>

            <div class="point">
                <strong>Read Preference</strong>
                <ul>
                    <li><strong>primary</strong> &mdash; always read from primary (default, strongest consistency)</li>
                    <li><strong>secondary</strong> &mdash; read from secondaries (for analytics, may be stale)</li>
                    <li><strong>nearest</strong> &mdash; lowest latency node</li>
                </ul>
            </div>

            <div class="qa">
                <h3>Interview Q&A</h3>

                <div class="q">
                    <div class="question">Q: Why MongoDB over MySQL for medical data?</div>
                    <div class="answer">Medical records are semi-structured &mdash; each encounter has different fields, nested labs, NLP-extracted codes. MongoDB's flexible schema avoids ALTER TABLE. One patient doc embeds vitals + diagnoses + AI-codes as nested objects, <strong>no JOINs needed</strong> at read time.</div>
                </div>

                <div class="q">
                    <div class="question">Q: How does WiredTiger handle concurrency?</div>
                    <div class="answer"><strong>Document-level concurrency</strong> with MVCC (Multi-Version Concurrency Control). Readers see a consistent snapshot without blocking writers. Different from MySQL's row-level locking &mdash; MongoDB is optimistic, no lock waits on different docs.</div>
                </div>

                <div class="q">
                    <div class="question">Q: Max document size? What if data is bigger?</div>
                    <div class="answer"><strong>16MB</strong>. For larger files use <strong>GridFS</strong> (splits into 255KB chunks across fs.files + fs.chunks). Or store files in S3 and keep reference URL in MongoDB.</div>
                </div>

                <div class="q">
                    <div class="question">Q: Explain ObjectId structure.</div>
                    <div class="answer">12 bytes: <strong>4</strong> (unix timestamp) + <strong>5</strong> (random/machine) + <strong>3</strong> (incrementing counter). Unique across distributed systems. Roughly sortable by time.</div>
                </div>

                <div class="q">
                    <div class="question">Q: Difference between insertMany and bulkWrite?</div>
                    <div class="answer"><code>insertMany</code> = batch inserts only. <code>bulkWrite</code> = mixed operations (insert + update + delete) in one request. Use bulkWrite for Kafka event processing &mdash; batch hundreds of price/inventory updates per second.</div>
                </div>

                <div class="q">
                    <div class="question">Q: How does MongoDB ensure durability?</div>
                    <div class="answer">3 layers: (1) <strong>Journal/WAL</strong> synced every 50ms, (2) <strong>Checkpoint</strong> every 60s, (3) <strong>Write Concern</strong> &mdash; <code>w:"majority", j:true</code> for max safety. For healthcare, always use majority + journal.</div>
                </div>

                <div class="q">
                    <div class="question">Q: When to use which Read Preference?</div>
                    <div class="answer"><strong>primary</strong> for real-time medical coding (consistency matters). <strong>secondaryPreferred</strong> for analytics dashboards (slight staleness OK). <strong>nearest</strong> for geo-distributed reads (lowest latency).</div>
                </div>

                <div class="q">
                    <div class="question">Q: BSON vs JSON &mdash; why not just store JSON?</div>
                    <div class="answer">BSON adds types (Date, Decimal128, ObjectId) that JSON lacks. Has length prefixes for O(1) field skipping. Faster encode/decode. Slightly larger on wire but optimized for traversal.</div>
                </div>
            </div>
        </div>

    </main>
</div>

<script>
    // Highlight active sidebar link on scroll
    const links = document.querySelectorAll('.sidebar nav a');
    const sections = document.querySelectorAll('.concept');
    window.addEventListener('scroll', () => {
        let current = '';
        sections.forEach(s => {
            if (window.scrollY >= s.offsetTop - 100) current = s.id;
        });
        links.forEach(a => {
            a.classList.remove('active');
            if (a.getAttribute('href') === '#' + current) a.classList.add('active');
        });
    });
</script>
</body>
</html>